---
layout: post
title:  "[Toy Project]기둥 뒤에 사람 있어요"
subtitle: "인원 재실 여부로 불을 끄는 모델 설계"
date:   2019-02-20 17:08:13 -0400
categories: Projects
background: '/img/posts/02.jpg'
---

# 들어가며
- 이 프로젝트는 데이터 분석 과정의 흐름을 보여주기 위한 간단한 toy project입니다.
- 이 프로젝트는 <a href="https://sohnnn.tistory.com/">손진원</a>, <a href="https://github.com/kwj962004">김우정</a>과 함께 진행했습니다.

<img src='/img/post3/figure_1.png' align="center" style="width: 50%; height: 50%"/>
---

# Introduction

어느 회사의 면접장. 면접관은 최종 질문으로 지원자의 장점을 말해보기를 요청하였다. 각종 경제 및 시사 상식, 해당 기업의 창립 년도까지 암기하였으나, 정작 필요한 건 준비하지 않았던 지원자는 엉겁결에 자신은 절약정신이 정말 투철하다며, 회사의 전기(傳記)를 허투루 쓰지 않겠다는 강한 의지를 내비쳤다. 그러나 돌아온 면접관의 ‘그걸 어떻게 알죠?’라는 물음에 면접장의 분위기는 급격히  얼어붙었다. 다른 것은 고만고만했으나 EQ(감성 지수)만은 확실히 뛰어났던 지원자는 면접관들의 비언어적 표현을 통해 자신의 면접이 망했음을 직감하였다. 그렇게 마지막 인사를 하고 터덜터덜 면접장을 나오며, 지원자는 습관적으로 불을 끄고 방을 나왔다. 그는 그 회사에 최종 합격하였다.

이 사례가 우리에게 주는 교훈은 자명하다. ‘회사의 전기(傳記)를 허투루 쓰지 말자.’ 강남역에서 술을 마시다보면, 주변 사무실에 새벽까지 층 전체에 불이 들어와있는 것을 목격하곤 한다. 그 층에 사람이 몇 명이나 있을지는 모르겠으나, 기껏해야 한 두명이라면 해당 기업의 CEO는 매우 분노할 것이다. 따라서 우리는 주어진 공간에 실제로 사람이 있는지 판별해주는 모델을 설계하여, 필요한 곳에만 조명이 들어오게 함으로써 회사의 영업이익 극대화에 기여하고 CEO로부터 칭찬을 듣고 싶었다.

### 데이터 요약
- 사용된 데이터 : Occupancy Detection Data Set
- 데이터 출처 : UCI Machine Learning Repository(https://archive.ics.uci.edu/ml/datasets/Occupancy+Detection+)
- 시간 단위로 측정된 사람의 재실 여부와 그에 관련 있을 것으로 보이는 5가지 변수 + 날짜 및 시간
- 측정 기간
    - training data : 15.02.04(수) 17시 51분 ~ 15.02.10(화) 09시 33분
    - test data : 15.02.02(월) 14시 19분 ~ 15.02.04(수) 10시 43분
    - test data2 : 15.02.11(수) 14시 48분 ~ 15.02.18(수) 09시 19분

### 변수 이름 및 설명
- datetime : 년, 월, 일, 시, 분. 초
- Temperature : 섭씨로 측정된 사무실의 온도
- Humidity : 사무실의 습도(%)
- Light : Lux 단위로 측정된 사무실의 빛의 밝기
- CO2 : ppm 단위로 측정된 사무실의 이산화탄소 농도
- Humidity Ratio : 온도와 습도를 이용하여 kgwater-vapor/kg-air 방식으로 계산된 습도 비율
- Occupancy : 1이면 재실중, 0이면 사람이 없는 상태. 반응 변수로 사용.

### 주제 선정의 배경

처음 데이터를 접하고 주제를 선정하기 전에 간단한 EDA를 동해 데이터를 탐색하던 중, 한 가지 특이한 사실을 발견하였다. 아래 그림을 확인해보자.  

<img src='/img/post4/pre_1.png' align="center" style="width: 50%; height: 50%"/>

위의 그림은 training과 test 데이터에 대하여, 평일의 시간대별 빛의 밝기의 평균값을 그린 것이다. 아래는 같은 조건 하에서 시간대별 평균 재실 비율을 그린 것이다. 두 그래프가 놀랍도록 비슷하게 생긴 것을 확인할 수 있다. 그 이유를 상식적으로 추정해보았을 때, 사무실에 사람이 있는데 굳이 불을 끄고 있을 이유가 없고, 퇴근할 때 불을 켜둘 이유가 없기 때문이라고 생각하였다. 만약 그런 일이 일어난다면, 사무실 사람들이 실수를 했든, 연구자를 일부러 방해하려고 했든 둘 중의 하나일 것이다. 따라서 먼저 간단히 light 변수만으로 재실 여부를 추정해보기로 하였다. Binary classification 문제에 사용되는 가장 간단한 모델인 로지스틱 회귀를 수행해보았으며, 그 결과는 아래와 같다.

- training accuracy : 98.25%
- test1 accuracy : 97.86%
- test2 accuracy : 99.17%

위에서 확인할 수 있듯이, 결과가 매우 잘 나온다. Test set에 대하여 99.17%의 분류 정확도를 보인다는 것은, 일반화도 매우 잘된 모델이라는 의미이다. 사실 단순히 사람이 재실 중이다 혹은 아니다를 분류하고자 한다면, 이 정도에서 끝내도 충분히 괜찮은 연구지만 이 연구에는 큰 문제가 하나 있다. **도대체 이 분류의 목적은 무엇인가?** 로지스틱 회귀 분석이 이렇게나 강력한 모델이다를 자랑하고 싶은게 아니라면 그닥 쓸모는 없어보인다. 따라서 우리는 **사람이 없으면 불을 끌 수 있도록** 모델을 통해 파악해보자 라는 실용적인 목표를 설정하였다. 이를 위해서, 분석 과정에서 Light 변수는 독립변수로 사용하지 않았다. 

# EDA

### 주말 출근 여부





